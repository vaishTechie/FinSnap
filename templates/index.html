<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FinSnap | Economy News</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">
   
</head>
<body>
    
    <div class="theme-switcher">
        <button class="theme-btn" onclick="setTheme('light')" title="Light Mode">
            <i class="fas fa-sun"></i>
        </button>
        <button class="theme-btn" onclick="setTheme('dark')" title="Dark Mode">
            <i class="fas fa-moon"></i>
        </button>
        <button class="theme-btn" onclick="setTheme('system')" title="System Theme">
            <i class="fas fa-desktop"></i>
        </button>
    </div>


    <h1 class="heading">FinSnap</h1>

    <div class="search-container">
        <input type="text" id="searchBar" class="search-bar" placeholder="Search articles..." onkeyup="searchArticles()">
    </div>

    <p class="text">What are you looking for?</p>

    <div class="tabs">
        <div class="tab" onclick="filterByCategory('trending')">Trending</div>
        <div class="tab" onclick="filterByCategory('gst')">GST</div>
        <div class="tab" onclick="filterByCategory('indian economy')">Indian Economy</div>
        <div class="tab" onclick="filterByCategory('global')">Global</div>
    </div>

    <div class="container" id="articlesContainer">
        {% for article in articles %}
        <div class="card {{ article['source'].lower().replace(' ', '-') }}" data-headline="{{ article['headline'] }}" data-summary="{{ article['summary'] }}" data-source="{{ article['source'] }}">
            <img src="{{ article['image'] }}" alt="Article Image">
            <div class="card-content">
                <h3 class="heado">{{ article['headline'] }}</h3>
                <p class="para">{{ article['summary'] }}</p>
                <div class="card-actions">
                    <div class="reaction-buttons">
                        <button class="reaction-button" data-type="heart" onclick="react(this, '‚ù§Ô∏è')">
                            ‚ù§Ô∏è <span class="reaction-count">0</span>
                        </button>
                        <button class="reaction-button" data-type="like" onclick="react(this, 'üëç')">
                            üëç <span class="reaction-count">0</span>
                        </button>
                         <button class="reaction-button" data-type="thumbsDown" onclick="react(this, 'üëé')">
        üëé <span class="reaction-count">0</span>
    </button>
    <button class="reaction-button" data-type="laugh" onclick="react(this, 'üòÇ')">
        üòÇ <span class="reaction-count">0</span>
    </button>
    <button class="reaction-button" data-type="hundred" onclick="react(this, 'üíØ')">
        üíØ <span class="reaction-count">0</span>
    </button>
                        
                    </div>
                    <div class="action-buttons">
                        <button class="action-btn share-btn" onclick="shareArticle(this)">
                            <i class="fas fa-share-alt"></i> Share
                        </button>
                        <button class="action-btn bookmark-btn" onclick="toggleBookmark(this)">
                            <i class="far fa-bookmark"></i> Save
                        </button>
                        <button class="translate-btn" onclick="translateCard(this)">
                            <i class="fas fa-language"></i> ‡§π‡§ø‡§Ç‡§¶‡•Ä
                        </button>
                    </div>
                </div>
                <div class="card-footer">
                    <div class="source">
                        <a href="{{ article['link'] }}" target="_blank">Read More @ {{ article['source'] }}</a>
                    </div>
                    {% if article['time'] %}
                    <div class="time">
                        <i>Published: {{ article['time'] }}</i>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    <div class="back-button" id="backButton">
        <button onclick="goBack()">Back to All Articles</button>
    </div>

    <div class="about-us-container">
        <div class="about-us-content">
            <h2 class="about-title">About FinSnap</h2>
            <p class="about-text">FinSnap is your premier destination for curated financial news summaries from trusted sources worldwide. We aggregate and simplify complex financial information to help you stay informed with just a snap.</p>
            <div class="about-features">
                <div class="feature">
                    <i class="fas fa-bolt feature-icon"></i>
                    <span class="spano">Real-time Updates</span>
                </div>
                <div class="feature">
                    <i class="fas fa-globe feature-icon"></i>
                    <span class="spano">Global Coverage</span>
                </div>
                <div class="feature">
                    <i class="fas fa-chart-line feature-icon"></i>
                    <span class="spano">Market Analysis</span>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Footer -->
    <footer class="site-footer">
        <div class="footer-content">
            <div class="footer-section">
                <h3>Connect With Us</h3>
                <div class="social-links">
                    <a href="#" class="social-link"><i class="fab fa-twitter"></i></a>
                    <a href="#" class="social-link"><i class="fab fa-linkedin"></i></a>
                    <a href="#" class="social-link"><i class="fab fa-instagram"></i></a>
                    <a href="#" class="social-link"><i class="fab fa-facebook"></i></a>
                </div>
            </div>
            <div class="footer-section">
                <h3>Quick Links</h3>
                <ul class="footer-links">
                    <li><a href="#">Terms of Service</a></li>
                    <li><a href="#">Privacy Policy</a></li>
                    <li><a href="#">Contact Us</a></li>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2024 FinSnap. All rights reserved.</p>
        </div>
    </footer>

    

    <script>
        function setTheme(theme) {
            const buttons = document.querySelectorAll('.theme-btn');
            buttons.forEach(btn => btn.classList.remove('active'));
            
            if (theme === 'system') {
                // Check system preference
                if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
                    document.documentElement.setAttribute('data-theme', 'dark');
                } else {
                    document.documentElement.setAttribute('data-theme', 'light');
                }
                document.querySelector('.theme-btn:nth-child(3)').classList.add('active');
            } else {
                document.documentElement.setAttribute('data-theme', theme);
                document.querySelector(`.theme-btn:nth-child(${theme === 'light' ? 1 : 2})`).classList.add('active');
            }
            
            localStorage.setItem('theme-preference', theme);
        }

        // Initialize theme
        function initializeTheme() {
            const savedTheme = localStorage.getItem('theme-preference') || 'system';
            setTheme(savedTheme);

            // Listen for system theme changes
            window.matchMedia('(prefers-color-scheme: dark)').addListener(() => {
                if (localStorage.getItem('theme-preference') === 'system') {
                    setTheme('system');
                }
            });
        }

        // Call initialize on page load
        document.addEventListener('DOMContentLoaded', initializeTheme);
function searchArticles() {
    var query = document.getElementById("searchBar").value.toLowerCase();
    var articles = document.querySelectorAll(".card");

    // Check if the query is empty
    if (query.trim() === "") {
        // If the query is empty, show all articles and remove any highlights
        articles.forEach(function(card) {
            card.style.display = "flex";
            removeHighlights(card.querySelector("h3"));
            removeHighlights(card.querySelector("p"));
        });
        return;
    }

    articles.forEach(function(card) {
        var headline = card.getAttribute("data-headline").toLowerCase();
        var summary = card.getAttribute("data-summary").toLowerCase();

        // Remove any existing highlights
        removeHighlights(card.querySelector("h3"));
        removeHighlights(card.querySelector("p"));

        // Check if the query matches the headline or summary
        if (headline.includes(query) || summary.includes(query)) {
            card.style.display = "flex";
            highlightText(card.querySelector("h3"), query);
            highlightText(card.querySelector("p"), query);
        } else {
            card.style.display = "none";
        }
    });
}

function highlightText(element, query) {
    var text = element.textContent || element.innerText;
    var regex = new RegExp('(' + query + ')', 'gi');
    var highlightedText = text.replace(regex, '<span class="highlight">$1</span>');
    element.innerHTML = highlightedText;
}

function removeHighlights(element) {
    if (element) {
        // Remove any highlight spans
        element.innerHTML = element.textContent || element.innerText;
    }
}





    
        // Run this after the page loads
document.addEventListener('DOMContentLoaded', function() {
    // Keep track of sources we've seen
    const seenSources = new Set();
    
    // Get all cards
    const cards = document.querySelectorAll('.card');
    
    // Add fire icon to first occurrence of each source
    // Add animated icon for the first occurrence of each source
// Add thunderbolt icon for the first occurrence of each source
// Add animated icon for the first occurrence of each source
cards.forEach(card => {
    const source = card.getAttribute('data-source');
    if (!seenSources.has(source)) {
        // Add animated icon instead of the fire emoji
        const animatedIcon = document.createElement('div');
        animatedIcon.innerHTML = '<span class="trending-icon">üî•</span>';
        animatedIcon.style.cssText = `
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 2;
        `;
        card.appendChild(animatedIcon);
        seenSources.add(source);
    }
});







});
let currentCategory = null;

function filterByCategory(category) {
    const tabs = document.querySelectorAll('.tab');
    const backButton = document.getElementById('backButton');

    // If clicking the same tab again, deactivate it
    if (currentCategory === category) {
        currentCategory = null;
        tabs.forEach(tab => {
            tab.classList.remove('active');
            tab.style.boxShadow = '';  // Remove glow effect when not active
        });
        // Show all articles
        document.querySelectorAll(".card").forEach(card => {
            card.style.display = "flex";
        });
        backButton.style.display = "none";  // Hide back button when no category is selected
        return;
    }

    currentCategory = category;  // Update current category

    // Update tab styling
    tabs.forEach(tab => {
        if (tab.textContent.toLowerCase() === category.toLowerCase()) {
            tab.classList.add('active');
            tab.style.boxShadow = '0 0 10px 2px rgba(0, 86, 179, 0.6)';  // Add glow effect
        } else {
            tab.classList.remove('active');
            tab.style.boxShadow = '';  // Remove glow effect from inactive tabs
        }
    });

    var articles = document.querySelectorAll(".card");

    articles.forEach(function(card) {
        var headline = card.getAttribute("data-headline").toLowerCase();
        var summary = card.getAttribute("data-summary").toLowerCase();
        var source = card.getAttribute("data-source").toLowerCase();
        var hasFire = Array.from(card.children).some(child => 
            child.textContent.includes('üî•')
        );

        card.style.display = "flex";  // Show all cards by default

        switch(category) {
            case 'trending':
                card.style.display = hasFire ? "flex" : "none";
                break;
            case 'gst':
                if (!headline.includes("gst") && !summary.includes("gst")) {
                    card.style.display = "none";
                }
                break;
            case 'indian economy':
                if (!headline.includes("india") && !summary.includes("india") && 
                    !headline.includes("nirmala sitharaman") && !summary.includes("nirmala sitharaman")) {
                    card.style.display = "none";
                }
                break;
            case 'global':
                if (!headline.includes("donald trump") && !summary.includes("donald trump") && 
                    !headline.includes("us") && !summary.includes("us") && 
                    !headline.includes("america") && !summary.includes("america")) {
                    card.style.display = "none";
                }
                break;
        }
    });

    backButton.style.display = "block";  // Show back button when a category is selected
}

function goBack() {
    // Show all articles
    currentCategory = null;  // Reset current category
    const tabs = document.querySelectorAll('.tab');
    tabs.forEach(tab => {
        tab.classList.remove('active');
        tab.style.boxShadow = '';  // Remove glow effect when going back
    });
    document.querySelectorAll(".card").forEach(card => {
        card.style.display = "flex";  // Show all cards again
    });
    document.getElementById('backButton').style.display = "none";  // Hide back button
}
// Add to your existing JavaScript

// Font Awesome CDN - Add this in your head section
document.head.innerHTML += '<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">';

// Reaction System
// Add this CSS at the start of your file
const styles = `
.reaction-button {
    position: relative;
    background: none;
    border: none;
    cursor: pointer;
    padding: 5px 10px;
    transition: transform 0.2s;
}

.reaction-button.reacted {
    color: #ff4b6e;
    transform: scale(1.1);
}

.card {
    position: relative;
    overflow: hidden;  /* Ensure effects don't spill outside during animation */
}

.reaction-effect {
    position: absolute;
    pointer-events: none;
    animation: floatUpAndFade 1.5s ease-out forwards;
    opacity: 0;
    font-size: 24px;  /* Larger emoji size */
    z-index: 10;
    transform-origin: center;
}

@keyframes floatUpAndFade {
    0% {
        transform: translateY(0) scale(0.5) rotate(-15deg);
        opacity: 0;
    }
    10% {
        opacity: 1;
    }
    100% {
        transform: translateY(-200px) scale(1.5) rotate(15deg);
        opacity: 0;
    }
}

.reaction-count {
    font-size: 0.9em;
    margin-left: 4px;
}`;

// Add the styles to the document
const styleSheet = document.createElement("style");
styleSheet.textContent = styles;
document.head.appendChild(styleSheet);

// Initialize reaction counts for each card
function initializeReactions() {
    const cards = document.querySelectorAll('.card');
    cards.forEach(card => {
        if (!card.dataset.reactionsInitialized) {
            const defaultCounts = {
                heart: Math.floor(Math.random() * 50) + 10,
                like: Math.floor(Math.random() * 40) + 5,
                thumbsDown: Math.floor(Math.random() * 20) + 5,
                laugh: Math.floor(Math.random() * 30) + 5,
                hundred: Math.floor(Math.random() * 25) + 5
            };
            
            card.dataset.reactionsInitialized = 'true';
            card.dataset.currentReaction = '';
            
            const reactionButtons = card.querySelectorAll('.reaction-button');
            reactionButtons.forEach(button => {
                const type = button.dataset.type;
                const countSpan = button.querySelector('.reaction-count');
                countSpan.textContent = defaultCounts[type];
            });
        }
    });
}

// Create floating effect elements spread across the card
function createFloatingEffect(card, emoji, count) {
    const cardRect = card.getBoundingClientRect();
    const effectContainer = card;
    
    for (let i = 0; i < count; i++) {
        setTimeout(() => {
            const effect = document.createElement('span');
            effect.className = 'reaction-effect';
            effect.textContent = emoji;
            
            // Random starting position across the bottom of the card
            const startX = Math.random() * (cardRect.width - 40);
            const startY = cardRect.height - 60;
            
            // Random horizontal drift
            const drift = (Math.random() - 0.5) * 100;
            
            effect.style.left = `${startX}px`;
            effect.style.bottom = '60px';
            
            // Add some random rotation and scaling variation
            const rotation = (Math.random() - 0.5) * 30;
            const scale = 0.8 + Math.random() * 0.4;
            const duration = 1 + Math.random() * 0.5;
            
            effect.style.animation = `floatUpAndFade ${duration}s ease-out forwards`;
            effect.style.transform = `rotate(${rotation}deg) scale(${scale})`;
            
            effectContainer.appendChild(effect);
            
            // Remove the element after animation
            setTimeout(() => effect.remove(), duration * 1000);
        }, i * 100);
    }
}

// Updated reaction function
function react(button, emoji) {
    const card = button.closest('.card');
    const countSpan = button.querySelector('.reaction-count');
    const currentReaction = card.dataset.currentReaction;
    const type = button.dataset.type;
    
    // If clicking the same reaction
    if (currentReaction === type) {
        // Remove reaction
        button.classList.remove('reacted');
        countSpan.textContent = parseInt(countSpan.textContent) - 1;
        card.dataset.currentReaction = '';
    } else {
        // If there was a previous reaction, decrease its count
        if (currentReaction) {
            const prevButton = card.querySelector(`[data-type="${currentReaction}"]`);
            const prevCount = prevButton.querySelector('.reaction-count');
            prevButton.classList.remove('reacted');
            prevCount.textContent = parseInt(prevCount.textContent) - 1;
        }
        
        // Add new reaction
        button.classList.add('reacted');
        countSpan.textContent = parseInt(countSpan.textContent) + 1;
        card.dataset.currentReaction = type;
        
        // Create floating effect across the card
        createFloatingEffect(card, emoji, 12);
    }
}

// Initialize reactions when the page loads
document.addEventListener('DOMContentLoaded', initializeReactions);




// Initialize reactions when the page loads
document.addEventListener('DOMContentLoaded', initializeReactions);
// Share Article
function shareArticle(button) {
    const card = button.closest('.card');
    const headline = card.querySelector('h3').textContent;
    const summary = card.querySelector('p').textContent;
    
    if (navigator.share) {
        navigator.share({
            title: headline,
            text: summary,
            url: window.location.href
        })
        .catch(console.error);
    } else {
        // Fallback for browsers that don't support Web Share API
        const dummy = document.createElement('textarea');
        dummy.value = `${headline}\n\n${summary}\n\n${window.location.href}`;
        document.body.appendChild(dummy);
        dummy.select();
        document.execCommand('copy');
        document.body.removeChild(dummy);
        alert('Link copied to clipboard!');
    }
}

// Bookmark System
function toggleBookmark(button) {
    button.classList.toggle('bookmarked');
    const icon = button.querySelector('i');
    if (button.classList.contains('bookmarked')) {
        icon.classList.replace('far', 'fas');
    } else {
        icon.classList.replace('fas', 'far');
    }
}

// Translation Function (using Google Translate API)
function translateCard(button) {
    const card = button.closest('.card');
    const headline = card.querySelector('h3');
    const summary = card.querySelector('p');
    
    if (!card.dataset.translated) {
        // This is a simplified version. In a real app, you'd want to use a translation API
        fetch(`https://translate.googleapis.com/translate_a/single?client=gtx&sl=en&tl=hi&dt=t&q=${encodeURIComponent(headline.textContent + '. ' + summary.textContent)}`)
            .then(response => response.json())
            .then(data => {
                const translatedText = data[0].map(x => x[0]).join(' ');
                const [translatedHeadline, ...translatedSummaryParts] = translatedText.split('‡•§');
                
                headline.dataset.original = headline.textContent;
                summary.dataset.original = summary.textContent;
                
                headline.textContent = translatedHeadline;
                summary.textContent = translatedSummaryParts.join('‡•§');
                
                card.dataset.translated = 'true';
                button.textContent = 'English';
            });
    } else {
        headline.textContent = headline.dataset.original;
        summary.textContent = summary.dataset.original;
        delete card.dataset.translated;
        button.textContent = '‡§π‡§ø‡§Ç‡§¶‡•Ä';
    }
}

    </script>
</body>
</html>   
